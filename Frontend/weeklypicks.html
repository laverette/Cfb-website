<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Picks</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="Resources/Styles/weeklypicks.css">
</head>
<body>
  <!-- Bouncing Football Background -->
  <div class="bouncing-football">
    <img src="https://cdn-icons-png.flaticon.com/512/1133/1133780.png" alt="American Football" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  
  <!-- Navbar -->
  <nav class="navbar bg-gold weeklypicks-navbar">
    <div class="container-fluid">
      <div class="navbar-content-weekly">
        <!-- Hamburger Menu Button -->
        <button class="hamburger-menu-btn" onclick="toggleMenu()" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
        
        <!-- Dropdown Menu -->
        <div class="dropdown-menu" id="dropdownMenu">
          <a href="index.html" class="dropdown-item">üè† Home</a>
          <a href="teams.HTML" class="dropdown-item">üèà Teams</a>
          <a href="weeklypicks.html" class="dropdown-item">üìÖ Weekly Picks</a>
          <a href="mypredictions.html" class="dropdown-item">üìä My Predictions</a>
          <a href="predictor.html" class="dropdown-item">ü§ñ Model</a>
          <a href="CFPPredictions.html" class="dropdown-item">üèÜ CFP Picks</a>
          <a href="list.html" class="dropdown-item">üëë Heisman Players</a>
        </div>
        
        <!-- Tab Buttons in Navbar -->
        <div class="navbar-tabs">
          <button class="tab-button active" onclick="openTab(event, 'week11-picks')">Week 13 Picks</button>
          <button class="tab-button" onclick="openTab(event, 'week10-results')">Week 12 Results</button>
        </div>
        
        <!-- Login Button -->
        <div class="navbar-login-section">
          <div id="loginButtonSection">
            <a href="login.html" class="navbar-login-btn">Login</a>
          </div>
          <div id="userSection" style="display: none;">
            <p id="userName" class="navbar-user-name"></p>
            <button id="logoutBtn" class="navbar-logout-btn">Logout</button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Week 11 Picks Tab -->
  <div id="week11-picks" class="tab-content active">
    <div class="title-section">
      <h1 class="title">Week 13 Picks</h1>
      <!-- Mobile Coach Corso Image (appears next to title) -->
      <div class="mobile-title-image">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
      </div>
    </div>
    
    <div class="week11-layout">
      <div class="form-section">
        <!-- Prediction Form -->
        <form name="predictions" method="POST" id="predictionsForm" netlify data-netlify="true">
          <input type="hidden" name="form-name" value="predictions" />
          <p>
            <label>Your Name: 
              <input id="yourname" name="user" type="text" required />
            </label>
          </p>
          
          <!-- Mobile Coach Corso Button (appears after name field, before Game 1) -->
          <div class="mobile-coach-corso">
            <div class="image-section">
              <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
              <button type="button" class="coach-corso-btn" onclick="scrollToCoachCorso(event)">Need Help? Ask Coach Corso!</button>
            </div>
          </div>
          
          <p>
            <label><span class="games">Game 1:</span> 
              <span class="team-row"><a href="team.html?name=Missouri%20Tigers" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/142.png" alt="Missouri" class="team-logo">Missouri</a> at 
              <a href="team.html?name=Oklahoma%20Sooners" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/201.png" alt="Oklahoma" class="team-logo">Oklahoma</a>
              <span class="betting-line">-7.5</span></span>
              <select name="game1">
                <option value="MIZ">MIZ</option>
                <option value="OU">OU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 2:</span> 
              <span class="team-row"><a href="team.html?name=USC%20Trojans" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/30.png" alt="USC" class="team-logo">USC</a> at 
              <a href="team.html?name=Oregon%20Ducks" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2483.png" alt="Oregon" class="team-logo">Oregon</a>
              <span class="betting-line">-9.5</span></span>
              <select name="game2">
                <option value="USC">USC</option>
                <option value="ORE">ORE</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 3:</span> 
              <span class="team-row"><a href="team.html?name=BYU%20Cougars" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/252.png" alt="BYU" class="team-logo">BYU</a> at 
              <a href="team.html?name=Cincinnati%20Bearcats" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2132.png" alt="Cincinnati" class="team-logo">Cincinnati</a>
              <span class="betting-line">+2.5</span></span>
              <select name="game3">
                <option value="BYU">BYU</option>
                <option value="CIN">CIN</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 4:</span> 
              <span class="team-row"><a href="team.html?name=Arizona%20State%20Sun%20Devils" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/9.png" alt="Arizona State" class="team-logo">Arizona State</a> at 
              <a href="team.html?name=Colorado%20Buffaloes" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/38.png" alt="Colorado" class="team-logo">Colorado</a>
              <span class="betting-line">-7.5</span></span>
              <select name="game4">
                <option value="ASU">ASU</option>
                <option value="COLO">COLO</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 5:</span> 
              <span class="team-row"><a href="team.html?name=Tennessee%20Volunteers" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2633.png" alt="Tennessee" class="team-logo">Tennessee</a> at 
              <a href="team.html?name=Florida%20Gators" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/57.png" alt="Florida" class="team-logo">Florida</a>
              <span class="betting-line">-4.5</span></span>
              <select name="game5">
                <option value="TENN">TENN</option>
                <option value="UF">UF</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 6:</span> 
              <span class="team-row"><a href="team.html?name=Pittsburgh%20Panthers" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/221.png" alt="Pittsburgh" class="team-logo">Pittsburgh</a> at 
              <a href="team.html?name=Georgia%20Tech%20Yellow%20Jackets" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/59.png" alt="Georgia Tech" class="team-logo">Georgia Tech</a>
              <span class="betting-line">-2.5</span></span>
              <select name="game6">
                <option value="PITT">PITT</option>
                <option value="GT">GT</option>
              </select>
            </label>
          </p>

          <p>
          <label><span class="games">Game 7:</span> 
              <span class="team-row"><a href="team.html?name=Kentucky%20Wildcats" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/96.png" alt="Kentucky" class="team-logo">Kentucky</a> at 
              <a href="team.html?name=Vanderbilt%20Commodores" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/238.png" alt="Vanderbilt" class="team-logo">Vanderbilt</a>
              <span class="betting-line">-9.5</span></span>
              <select name="game7">
                <option value="UK">UK</option>
                <option value="VAN">VAN</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 8:</span> 
              <span class="team-row"><a href="team.html?name=Arkansas%20Razorbacks" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/8.png" alt="Arkansas" class="team-logo">Arkansas</a> at 
              <a href="team.html?name=Texas%20Longhorns" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/251.png" alt="Texas" class="team-logo">Texas</a>
              <span class="betting-line">-8.5</span></span>
              <select name="game8">
                <option value="ARK">ARK</option>
                <option value="TEX">TEX</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 9:</span> 
              <span class="team-row"><a href="team.html?name=Kansas%20State%20Wildcats" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2306.png" alt="Kansas State" class="team-logo">Kansas State</a> at 
              <a href="team.html?name=Utah%20Utes" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/254.png" alt="Utah" class="team-logo">Utah</a>
              <span class="betting-line">-17.5</span></span>
              <select name="game9">
                <option value="KSU">KSU</option>
                <option value="UTAH">UTAH</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 10:</span> 
              <span class="team-row"><a href="team.html?name=Michigan%20Wolverines" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/130.png" alt="Michigan" class="team-logo">Michigan</a> at 
              <a href="team.html?name=Maryland%20Terrapins" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/120.png" alt="Maryland" class="team-logo">Maryland</a>
              <span class="betting-line">+13.5</span></span>
              <select name="game10">
                <option value="MICH">MICH</option>
                <option value="MD">MD</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 11:</span> 
              <span class="team-row"><a href="team.html?name=Tulane%20Green%20Wave" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2655.png" alt="Tulane" class="team-logo">Tulane</a> at 
              <a href="team.html?name=Temple%20Owls" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/218.png" alt="Temple" class="team-logo">Temple</a>
              <span class="betting-line">+7.5</span></span>
              <select name="game11">
                <option value="TUL">TUL</option>
                <option value="TEMP">TEMP</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 12:</span> 
              <span class="team-row"><a href="team.html?name=TCU%20Horned%20Frogs" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2628.png" alt="TCU" class="team-logo">TCU</a> at 
              <a href="team.html?name=Houston%20Cougars" class="team-link-inline"><img src="https://a.espncdn.com/i/teamlogos/ncaa/500/248.png" alt="Houston" class="team-logo">Houston</a>
              <span class="betting-line">-1.5</span></span>
              <select name="game12">
                <option value="TCU">TCU</option>
                <option value="HOU">HOU</option>
              </select>
            </label>
          </p>
             
          <p>
            <button id="submit" type="submit">Submit Predictions</button>
            <a href="prediction-history.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">View Individual History</a>
            <a href="index.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">Back to Main Site</a> 
            
          </p>
        </form>
        <div id="results"></div>
      </div>
      
      <div class="image-section">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
        <button type="button" class="coach-corso-btn" onclick="scrollToCoachCorso(event)">Need Help? Ask Coach Corso!</button>
      </div>
    </div>
    
    <!-- Coach Corso Says Section -->
    <div id="coach-corso-section" class="coach-corso-container">
      <h2 class="coach-corso-title">üèà Coach Corso Says...</h2>
      <div class="coach-corso-content">
          <div class="corso-tip">
            <span class="tip-icon">üçÅ</span>
            <span class="tip-text">The First Saturday in November! Alabama vs LSU! The Tide's defense is locked in, and LSU just lost their head coach. This one might not be as close as the 2019 classic, but it's still the biggest game in the SEC West! Roll Tide!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêï</span>
            <span class="tip-text">Georgia at Mississippi State! The Dawgs are #5 and rolling, but playing in Starkville is never easy. Still, Georgia should cover that 10-point spread!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üî•</span>
            <span class="tip-text">BYU at Texas Tech! Both teams are ranked in the top 10, but the Red Raiders are at home and favored by 10.5. Tech wins big!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üîµ</span>
            <span class="tip-text">Indiana at Penn State! The Hoosiers are #2 and favored, but Happy Valley is a tough place to play! Give me Indiana but it'll be close!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêÖ</span>
            <span class="tip-text">Texas A&M at Missouri! The Aggies are #3 and rolling, but the Tigers are at home. Still, A&M should handle business in Columbia!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">ü¶Ü</span>
            <span class="tip-text">Oregon at Iowa! The Ducks are #4 and favored by 7, but Kinnick Stadium at night is no joke. Oregon wins but Iowa covers!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêÖ</span>
            <span class="tip-text">Auburn at Vanderbilt! The Tigers are favored by 8, but Vandy has been playing tough at home. Give me Auburn to cover!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üî¥</span>
            <span class="tip-text">Washington at Wisconsin! The Badgers are favored by 3.5 at home in Camp Randall. That place gets LOUD! Wisconsin wins!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üåä</span>
            <span class="tip-text">Wake Forest at Virginia! The Cavaliers are favored by 4.5 at home. UVA takes care of business in Charlottesville!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêª</span>
            <span class="tip-text">California at Louisville! The Cardinals are favored by 6 at home. Louisville's offense should be too much for Cal!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">‚õ™</span>
            <span class="tip-text">Navy at Notre Dame! The Fighting Irish are #10 and favored by 7. Navy always plays ND tough, but the Irish win at home!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üê∏</span>
            <span class="tip-text">Iowa State at TCU! The Horned Frogs are favored by 2 at home. This is a toss-up, but give me TCU in Fort Worth!</span>
          </div>
      </div>
    </div>
  </div>

  <!-- Week 10 Results Tab -->
  <div id="week10-results" class="tab-content">
    <h1 class="title">Week 12 Results</h1>
    
    <div class="leaderboards-container">
      <div class="Leaderboard last-week">
        <h3 class="leaderboard-title">üèÜ Last Week</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Michaela 11-1 <span class="percentage">92%</span><span class="ranking-change up">‚ñ≤ 3</span></li>
          <li class="leaderboard-list-item">Logan 11-1 <span class="percentage">92%</span><span class="ranking-change down">‚ñº 1</span></li>
          <li class="leaderboard-list-item">Blake's AI Model 11-1 <span class="percentage">92%</span><span class="ranking-change up">‚ñ≤ 4</span></li>
          <li class="leaderboard-list-item">Gracie 9-3 <span class="percentage">75%</span><span class="ranking-change down">‚ñº 2</span></li>
          <li class="leaderboard-list-item">Katelyn 9-3<span class="percentage">75%</span><span class="ranking-change down">‚ñº 2</span></li>
          <li class="leaderboard-list-item">Blake 9-3 <span class="percentage">75%</span><span class="ranking-change down">‚ñº 1</span></li>
          <li class="leaderboard-list-item">Chase 9-3 <span class="percentage">75%</span><span class="ranking-change down">‚ñº 1</span></li> 
        </ol>
      </div>
      <div class="Leaderboard all-time">
        <h3 class="leaderboard-title">üèÜ All Time</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Michaela 88-32 <span class="percentage">73.33%</span><span class="ranking-change up">‚ñ≤ 1</span></li>
          <li class="leaderboard-list-item">Blake 96-36 <span class="percentage">72.73%</span><span class="ranking-change down">‚ñº 1</span></li>
          <li class="leaderboard-list-item">Gracie 85-35 <span class="percentage">70.83%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Logan 93-39 <span class="percentage">70.45%</span><span class="ranking-change up">‚ñ≤ 1</span></li>
          <li class="leaderboard-list-item">Katelyn 84-36 <span class="percentage">70%</span><span class="ranking-change down">‚ñº 1</span></li>
          <li class="leaderboard-list-item">Blake's AI Model 42-18  <span class="percentage">70%</span><span class="ranking-change none">‚Äî</span></li>
          <li class="leaderboard-list-item">Chase 47-25 <span class="percentage">65.28%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Allie 22-14 <span class="percentage">61.1%</span><span class="ranking-change none">-</span></li>
        </ol>
      </div>
    </div>

    <!-- WEEK 10 Analysis Section -->
    <div class="analysis-container">
      <h3 class="analysis-title">üìä WEEK 12 Analysis</h3>
      <div class="analysis-content">
        <div class="analysis-stats">
          <div class="stat-highlight">
            <span class="stat-icon">üìâ</span>
            <span class="stat-text">We have a new number one in the all time rankings! Michaela is now number ONE after going 11-1</span>
          </div>
          <div class="stat-highlight">
              <span class="stat-icon">üò±</span>
              <span class="stat-text">No one correctly picked Oklahoma to upset Alabama this week</span>
            </div>
          <div class="stat-highlight">
            <span class="stat-icon">‚úÖ</span>
            <span class="stat-text">Middle of the Pack: 4 different users are withing .83% of each other in the all time rankings</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üìâ</span>
            <span class="stat-text">All users combined this week went 69-15 (82.1%). Up 20.2% from last week, and good for the best week of the season</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">‚úÖ</span>
            <span class="stat-text">USC vs Iowa was the most divisive game of the week, with 4 picks for USC and 3 for Iowa</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üé∞</span>
            <span class="stat-text">Gracie, Katelyn, and Chase foolishly bet against the mormons this week and lost big time</span>
          </div>
        </div>
        
        <div class="analysis-insights">
          <h4 class="insights-title">üîë Keys for Week 13</h4>
          <ul class="insights-list">
            <li>Will Alabama bounce back?</li>
            <li>The SEC Championship is now a 4 way race with Alabama, Georgia, Texas A&M, and slightly possible (Ole Miss)</li>
            <li>Does anyone really want the heisman?</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  



    <script>
    // Login/Logout functionality - simplified, no authentication required
    let currentUser = null;

    // Check if user is logged in on page load (optional, no requirement)
    document.addEventListener('DOMContentLoaded', function() {
      const savedUser = localStorage.getItem('currentUser');
      const authToken = localStorage.getItem('authToken');
      
      if (savedUser && authToken) {
        currentUser = JSON.parse(savedUser);
        showUserSection();
        
        // Pre-fill name field with username or displayName if available
        const nameInput = document.getElementById('yourname');
        if (nameInput && currentUser) {
          nameInput.value = currentUser.displayName || currentUser.username || '';
        }
        
        // Database submission check removed - using Netlify Forms only
      } else {
        showLoginButton();
      }
    });

    // Logout handler
    document.getElementById('logoutBtn')?.addEventListener('click', function() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      localStorage.removeItem('authToken');
      showLoginButton();
      
      // Clear name field
      const nameInput = document.getElementById('yourname');
      if (nameInput) {
        nameInput.value = '';
      }
    });

    function showUserSection() {
      const loginSection = document.getElementById('loginButtonSection');
      const userSection = document.getElementById('userSection');
      if (loginSection) loginSection.style.display = 'none';
      if (userSection) {
        userSection.style.display = 'block';
        // Display username or displayName
        const displayName = currentUser?.displayName || currentUser?.username || 'User';
        const userNameEl = document.getElementById('userName');
        if (userNameEl) userNameEl.textContent = displayName;
      }
    }

    function showLoginButton() {
      const loginSection = document.getElementById('loginButtonSection');
      const userSection = document.getElementById('userSection');
      if (loginSection) loginSection.style.display = 'block';
      if (userSection) userSection.style.display = 'none';
    }

    const weekId = 13; // Update this to match your week_id from database (check Weeks table)

    // Check if user has already submitted predictions for this week
    async function checkSubmissionStatus() {
      const authToken = localStorage.getItem('authToken');
      if (!authToken || !currentUser) {
        return; // Not logged in, can't check
      }

      try {
        const response = await fetch(`https://cfb-website.onrender.com/api/picks/check-submission/${weekId}`, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${authToken}`,
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          try {
            const result = await response.json();
            
            if (result.hasSubmitted) {
              // User has already submitted - disable form
              disableFormForAlreadySubmitted();
              
              // Show their previous submission
              if (result.pickCount > 0) {
                showAlreadySubmittedMessage(result.lastSubmitted);
                loadPreviousSubmission();
              }
            }
          } catch (jsonError) {
            // Silently fail - API may not be available
          }
        }
        // Silently ignore 404s - API may not be deployed yet
      } catch (error) {
        // Silently ignore errors - don't clutter console on page load
        // API may not be available, which is fine
      }
    }

    // Disable form if user has already submitted
    function disableFormForAlreadySubmitted() {
      const form = document.querySelector('form[name="predictions"]');
      if (!form) return;

      // Disable all form inputs
      const inputs = form.querySelectorAll('input, select, button[type="submit"]');
      inputs.forEach(input => {
        input.disabled = true;
        input.style.opacity = '0.6';
        input.style.cursor = 'not-allowed';
      });

      // Hide submit button
      const submitBtn = document.getElementById('submit');
      if (submitBtn) {
        submitBtn.style.display = 'none';
      }

      // Add visual indicator
      const formSection = document.querySelector('.form-section');
      if (formSection) {
        formSection.style.position = 'relative';
      }
    }

    // Show message that user has already submitted
    function showAlreadySubmittedMessage(lastSubmitted) {
      const form = document.querySelector('form[name="predictions"]');
      if (!form) return;

      const submittedDate = lastSubmitted ? new Date(lastSubmitted).toLocaleString() : 'previously';
      
      const messageDiv = document.createElement('div');
      messageDiv.className = 'already-submitted-message';
      messageDiv.style.cssText = `
        background: linear-gradient(135deg, #FFD700, #FFA000);
        color: #1E1E1E;
        padding: 1.5rem;
        border-radius: 12px;
        margin: 1rem 0;
        text-align: center;
        font-weight: bold;
        box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
        border: 2px solid #FFD700;
      `;
      // Get week number from title
      const titleElement = document.querySelector('.title');
      const weekText = titleElement ? titleElement.textContent.match(/Week (\d+)/) : null;
      const weekNumber = weekText ? weekText[1] : weekId;
      
      messageDiv.innerHTML = `
        <h3 style="margin: 0 0 0.5rem 0; color: #1E1E1E;">‚úÖ Already Submitted!</h3>
        <p style="margin: 0; color: #1E1E1E;">
          You've already submitted your predictions for Week ${weekNumber}.<br>
          <small style="font-size: 0.9em;">Submitted: ${submittedDate}</small>
        </p>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.9em; color: #1E1E1E; opacity: 0.9;">
          Only one submission per week is allowed.
        </p>
      `;

      // Insert before the form
      form.parentNode.insertBefore(messageDiv, form);
    }

    // Load and display previous submission
    async function loadPreviousSubmission() {
      const authToken = localStorage.getItem('authToken');
      if (!authToken) return;

      try {
        const response = await fetch(`https://cfb-website.onrender.com/api/picks/week/${weekId}`, {
          method: 'GET',
          headers: {
            'Authorization': `Bearer ${authToken}`,
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          try {
            const result = await response.json();
            
            if (result.picks && result.picks.length > 0) {
              // Pre-fill form with previous picks (read-only)
              result.picks.forEach(pick => {
                const gameNumber = pick.gameNumber;
                const select = document.querySelector(`select[name="game${gameNumber}"]`);
                
                if (select) {
                  // Find the option that matches the picked team
                  const options = select.querySelectorAll('option');
                  options.forEach(option => {
                    const optionValue = option.value;
                    const espnId = teamCodeToEspnId[optionValue];
                    
                    if (espnId === pick.pickedTeamEspnId) {
                      option.selected = true;
                    }
                  });
                }
              });
            }
          } catch (jsonError) {
            // Silently ignore - API may not be available
          }
        }
        // Silently ignore 404s - API may not be deployed
      } catch (error) {
        // Silently ignore - API may not be available
      }
    }

    // Team code to ESPN ID mapping (for the dropdown values)
    const teamCodeToEspnId = {
      // Game 1: Missouri at Oklahoma
      'MIZ': 142, 'OU': 201,
      // Game 2: USC at Oregon
      'USC': 30, 'ORE': 2483,
      // Game 3: BYU at Cincinnati
      'BYU': 252, 'CIN': 2132,
      // Game 4: Arizona State at Colorado
      'ASU': 9, 'COLO': 38,
      // Game 5: Tennessee at Florida
      'TENN': 2633, 'UF': 57,
      // Game 6: Pittsburgh at Georgia Tech
      'PITT': 221, 'GT': 59,
      // Game 7: Kentucky at Vanderbilt
      'UK': 96, 'VAN': 238,
      // Game 8: Arkansas at Texas
      'ARK': 8, 'TEX': 251,
      // Game 9: Kansas State at Utah
      'KSU': 2306, 'UTAH': 254,
      // Game 10: Michigan at Maryland
      'MICH': 130, 'MD': 120,
      // Game 11: Tulane at Temple
      'TUL': 2655, 'TEMP': 218,
      // Game 12: TCU at Houston
      'TCU': 2628, 'HOU': 248
    };

    // No longer need to load games from API - we use game_number (1-12) directly

    // Submission status check removed - no authentication required

    // Prediction form handler - Submit to Netlify Forms
    document.querySelector('form[name="predictions"]').addEventListener('submit', async function(e) {
      e.preventDefault();

      const form = e.target;
      const formData = new FormData(form);
      
      // Validate all picks are selected
      const missingPicks = [];
      
      for (let i = 1; i <= 12; i++) {
        const pickedCode = formData.get(`game${i}`);
        if (!pickedCode) {
          missingPicks.push(`Game ${i}`);
        }
      }

      if (missingPicks.length > 0) {
        alert(`Please select picks for all 12 games!\n\nMissing: ${missingPicks.length} games`);
        return;
      }

      // Show loading state
      const submitBtn = document.getElementById('submit');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting...';
      submitBtn.disabled = true;
      
      // Build preview - display picks normally (show this regardless of submission status)
      const userName = formData.get("user") || currentUser?.displayName || currentUser?.username || "Guest";
      
      try {
        // Submit to Netlify Forms in the background
        // Convert FormData to URLSearchParams for Netlify
        const formDataParams = new URLSearchParams();
        for (const [key, value] of formData.entries()) {
          formDataParams.append(key, value);
        }
        
        // Submit to Netlify (form-name is already in the form as hidden input)
        const response = await fetch('/', {
          method: 'POST',
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: formDataParams.toString()
        });
        
        // Netlify forms can return 200 (ok) or redirect (302), both are success
        // response.ok is true for 200-299, so we check for actual errors (400+)
        if (response.status >= 400) {
          console.warn(`Netlify submission warning: ${response.status} ${response.statusText}`);
          // Continue anyway to show preview
        } else {
          console.log('Successfully submitted to Netlify Forms');
        }
      } catch (submitError) {
        // Log error but continue to show preview
        console.warn('Netlify submission error (showing preview anyway):', submitError);
      }

      // Always show preview regardless of submission status
      let html = `
        <div class="prediction-results-container">
          <div class="prediction-header">
            <h2 class="prediction-title">üèÜ ${userName}'s Week 13 Predictions</h2>
          </div>
          <div class="predictions-grid">
      `;
      
      for (let i = 1; i <= 12; i++) {
        const gameData = [
        "Missouri at Oklahoma",
        "USC at Oregon",
        "BYU at Cincinnati",
        "Arizona State at Colorado",
        "Tennessee at Florida",
        "Pittsburgh at Georgia Tech",
        "Kentucky at Vanderbilt",
        "Arkansas at Texas",
        "Kansas State at Utah",
        "Michigan at Maryland",
        "Tulane at Temple",
        "TCU at Houston"
        ];
        
        const prediction = formData.get("game" + i);
        
        html += `
          <div class="prediction-card">
            <div class="game-info">
              <span class="game-number">Game ${i}</span>
              <span class="game-matchup">${gameData[i-1]}</span>
            </div>
            <div class="prediction-result">
              <span class="prediction-choice ${prediction.toLowerCase()}">${prediction}</span>
            </div>
          </div>
        `;
      }
      
      html += `
          </div>
          <div class="prediction-summary">
          <div class="summary-stats">
            <div class="stat-item">
              <span class="stat-number">12</span>
              <span class="stat-label">Total Picks</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Correct</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Accuracy</span>
            </div>
          </div>
            <div class="prediction-footer">
              <p class="success-message">‚úÖ Predictions submitted successfully!</p>
              <p class="next-steps">Check back after the games to see how you did!</p>
              <div class="screenshot-section">
                <button id="screenshotBtn" class="screenshot-button">
                  üì∏ Save to Photos
                </button>
                <p class="screenshot-note">Save your predictions to your camera roll!</p>
              </div>
            </div>
          </div>
        </div>
      `;
      
        // Show success message
        document.getElementById("results").innerHTML = html;
        
        // Scroll to results
        setTimeout(() => {
          document.getElementById("results").scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
          });
        }, 100);
        
        // Add screenshot functionality
        const screenshotBtn = document.getElementById('screenshotBtn');
        if (screenshotBtn) {
          screenshotBtn.addEventListener('click', function() {
            takeScreenshot();
          });
        }
        
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
    });

    // Screenshot functionality
    function takeScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Check if html2canvas is available (we'll add it via CDN)
      if (typeof html2canvas === 'undefined') {
        // Load html2canvas library
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
        script.onload = function() {
          captureScreenshot();
        };
        document.head.appendChild(script);
      } else {
        captureScreenshot();
      }
    }

    function captureScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Create a temporary container with only the content we want to screenshot
      const tempContainer = document.createElement('div');
      tempContainer.style.position = 'absolute';
      tempContainer.style.left = '-9999px';
      tempContainer.style.top = '-9999px';
      tempContainer.style.width = '100vw'; // Use full viewport width
      tempContainer.style.maxWidth = '100vw';
      tempContainer.style.backgroundColor = '#1E1E1E';
      tempContainer.style.padding = '1rem';
      tempContainer.style.borderRadius = '15px';
      tempContainer.style.border = '2px solid #FFD700';
      tempContainer.style.boxSizing = 'border-box';
      tempContainer.style.overflow = 'visible';
      
      // Clone the content we want (exclude success messages and screenshot button)
      const predictionContainer = resultsContainer.querySelector('.prediction-results-container');
      if (predictionContainer) {
        const clone = predictionContainer.cloneNode(true);
        
        // Remove the prediction footer (success messages and screenshot button)
        const footer = clone.querySelector('.prediction-footer');
        if (footer) {
          footer.remove();
        }
        
        // Ensure the predictions grid uses full width with 3 columns on mobile
        const predictionsGrid = clone.querySelector('.predictions-grid');
        if (predictionsGrid) {
          predictionsGrid.style.width = '100%';
          predictionsGrid.style.maxWidth = '100%';
          predictionsGrid.style.display = 'grid';
          predictionsGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
          predictionsGrid.style.gap = '0.3rem';
          predictionsGrid.style.padding = '0.3rem';
          predictionsGrid.style.margin = '0';
          predictionsGrid.style.boxSizing = 'border-box';
        }
        
        // Ensure each prediction card fits properly in 3 columns
        const predictionCards = clone.querySelectorAll('.prediction-card');
        predictionCards.forEach(card => {
          card.style.width = '100%';
          card.style.minWidth = '100px';
          card.style.maxWidth = '100%';
          card.style.boxSizing = 'border-box';
          card.style.padding = '0.3rem';
          card.style.fontSize = '0.7rem';
          card.style.margin = '0';
          card.style.overflow = 'visible';
        });
        
        tempContainer.appendChild(clone);
        document.body.appendChild(tempContainer);
      }
      
      html2canvas(tempContainer, {
        backgroundColor: '#1E1E1E',
        scale: 1.2, // Slightly reduced scale for better fit
        useCORS: true,
        allowTaint: true,
        scrollX: 0,
        scrollY: 0,
        width: tempContainer.scrollWidth,
        height: tempContainer.scrollHeight,
        logging: false,
        removeContainer: false,
        x: 0,
        y: 0
      }).then(canvas => {
        // Check if Web Share API is supported (mobile)
        if (navigator.share && navigator.canShare) {
          canvas.toBlob(function(blob) {
            const file = new File([blob], `week13-predictions-${new Date().toISOString().split('T')[0]}.png`, { 
              type: 'image/png' 
            });
            
            // Use Web Share API for mobile
            if (navigator.canShare({ files: [file] })) {
              navigator.share({
                files: [file],
                title: 'My Week 13 Predictions',
                text: 'Check out my college football predictions!'
              }).then(() => {
                showSuccessMessage('Shared! Check your share options to save to photos.');
              }).catch((error) => {
                console.log('Share failed:', error);
                fallbackDownload(canvas);
              });
            } else {
              fallbackDownload(canvas);
            }
          });
        } else {
          // Fallback for desktop or unsupported browsers
          fallbackDownload(canvas);
        }
      }).catch(err => {
        console.error('Screenshot failed:', err);
        alert('Screenshot failed. Please try again.');
      }).finally(() => {
        // Clean up temporary container
        if (tempContainer && tempContainer.parentNode) {
          tempContainer.parentNode.removeChild(tempContainer);
        }
      });
    }

    function fallbackDownload(canvas) {
      // Create download link for desktop/fallback
      const link = document.createElement('a');
      link.download = `week13-predictions-${new Date().toISOString().split('T')[0]}.png`;
      link.href = canvas.toDataURL();
      
      // Trigger download
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showSuccessMessage('Downloaded! Check your Downloads folder.');
    }

    function showSuccessMessage(message) {
      const btn = document.getElementById('screenshotBtn');
      const originalText = btn.innerHTML;
      btn.innerHTML = '‚úÖ ' + message;
      btn.style.backgroundColor = '#4CAF50';
      
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.backgroundColor = '';
      }, 3000);
    }

    // Hamburger Menu Toggle
    function toggleMenu() {
      const menu = document.getElementById('dropdownMenu');
      const button = document.querySelector('.hamburger-menu-btn');
      menu.classList.toggle('show');
      button.classList.toggle('active');
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(event) {
      const menu = document.getElementById('dropdownMenu');
      const button = document.querySelector('.hamburger-menu-btn');
      if (!menu.contains(event.target) && !button.contains(event.target)) {
        menu.classList.remove('show');
        button.classList.remove('active');
      }
    });

    // Tab functionality
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      
      // Hide all tab content
      tabcontent = document.getElementsByClassName("tab-content");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].classList.remove("active");
      }
      
      // Remove active class from all tab buttons
      tablinks = document.getElementsByClassName("tab-button");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
      }
      
      // Show the selected tab content and mark the button as active
      document.getElementById(tabName).classList.add("active");
      evt.currentTarget.classList.add("active");
    }

    // Coach Corso scroll functionality
    function scrollToCoachCorso(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      document.getElementById('coach-corso-section').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }

    // Rivalry History Modal
    function showRivalryHistory() {
      const modal = document.createElement('div');
      modal.className = 'rivalry-modal';
      modal.innerHTML = `
        <div class="rivalry-modal-content">
          <div class="rivalry-modal-header">
            <h3>‚öîÔ∏è The Holy War</h3>
            <span class="close-modal" onclick="closeRivalryModal()">&times;</span>
          </div>
          <div class="rivalry-modal-body">
            <p><strong>Utah vs BYU</strong> - One of college football's most intense rivalries!</p>
            <p><strong>History:</strong> Dating back to 1896, this rivalry represents more than just football - it's a battle between the University of Utah (public, Heathens) and Brigham Young University (private, LDS-affiliated).</p>
            <p><strong>Notable Moments:</strong></p>
            <ul>
              <li>2004: Utah's perfect season with Urban Meyer</li>
              <li>2008: BYU's 48-24 victory in Provo</li>
              <li>2015: Utah's 35-28 thriller in Las Vegas Bowl</li>
            </ul>
            <p><strong>Series Record:</strong> Utah leads 62-31-4</p>
            <p><strong>Why "Holy War":</strong> The nickname reflects the religious and cultural differences between the two institutions, making every game a battle for state supremacy.</p>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function closeRivalryModal() {
      const modal = document.querySelector('.rivalry-modal');
      if (modal) {
        modal.remove();
      }
    }

    // The First Saturday in November Rivalry Modal
    function showFirstSaturdayRivalry() {
      const modal = document.createElement('div');
      modal.className = 'rivalry-modal';
      modal.innerHTML = `
        <div class="rivalry-modal-content">
          <div class="rivalry-modal-header">
            <h3><span style="font-size: 24px; margin-right: 8px;">üçÅ</span> The First Saturday in November</h3>
            <span class="close-modal" onclick="closeRivalryModal()">&times;</span>
          </div>
          <div class="rivalry-modal-body">
            <p><strong>Alabama vs LSU</strong> - The annual SEC West heavyweight bout that somehow always lives up to the hype.</p>
            <p><strong>This Year's Edition:</strong> Well, 2025's version looks a bit different than the 2019 "Game of the Century II" we all remember (you know, the one where Joe Burrow went nuclear and scored 46 points in Tuscaloosa). Fast forward six years and things have changed: LSU's head coach Brian Kelly got the boot after their shaky start, and now the Tigers are rolling with an interim coach who's probably still figuring out where the water cooler is.</p>
            <p><strong>What to Expect:</strong> The Crimson Tide defense is looking sharp this season, while LSU is... well, they're trying their best. The Tigers have that whole "spirited underdog" thing going for them, which is great for motivational speeches but not so great for actually winning football games against a well-coached Alabama team.</p>
            <p><strong>The Rivalry History:</strong> Dating back to 1895, this showdown has produced some absolute classics. Since Nick Saban arrived in Tuscaloosa in 2007, Alabama has dominated the series 12-4. Ten of those 16 games featured both teams in the top-10, and half were decided by a touchdown or less. This year might be slightly less dramatic, but hey, that's why they play the games.</p>
            <p><strong>Why It Still Matters:</strong> Even with LSU's current situation, this game means everything in the SEC West. Alabama's looking to secure their spot, while LSU's interim coach is probably hoping to keep the job for more than just this weekend. The stakes might be different, but the intensity? That never changes.</p>
            <p><strong>The Bottom Line:</strong> It's November in the SEC. Alabama's rolling. LSU's... regrouping. Time to see if the Tigers can channel some of that 2019 magic, or if the Tide will keep rolling right through Baton Rouge's coaching carousel.</p>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    // Show George Jewett Trophy Modal
    function showGeorgeJewettTrophyModal() {
      // Remove any existing modal first
      const existingModal = document.querySelector('.rivalry-modal');
      if (existingModal) {
        existingModal.remove();
      }

      const modal = document.createElement('div');
      modal.className = 'rivalry-modal';
      modal.innerHTML = `
        <div class="rivalry-modal-content">
          <div class="rivalry-modal-header">
            <h3><span style="font-size: 24px; margin-right: 8px;">üèÜ</span> George Jewett Trophy</h3>
            <span class="close-modal" onclick="closeRivalryModal()">&times;</span>
          </div>
          <div class="rivalry-modal-body">
            <p>This game features the battle for the <strong>George Jewett Trophy</strong>, honoring the first Black player in Big Ten history who played for both schools.</p>
            <p>George Jewett was a trailblazer who broke barriers in college football, and this trophy commemorates his legacy and the historic significance of this matchup between Michigan and Northwestern.</p>
            <div style="text-align: center; margin: 20px 0;">
              <img src="https://www.mgoblue.com/images/2024/9/26/George_Jewett_Trophy.jpg" alt="George Jewett Trophy" style="max-width: 100%; max-height: 400px; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);" onerror="this.style.display='none';">
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

</script>
</body>
</html>
