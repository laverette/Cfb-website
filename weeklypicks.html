<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Picks</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="./Resources/Styles/weeklypicks.css">
</head>
<body>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Login Button - Upper Right -->
  <div style="position: fixed; top: 10px; right: 10px; z-index: 1000; display: none;">
    <div id="loginButtonSection">
      <a href="login.html" style="background-color: #3E2723; color: #F5F5F5; padding: 8px 16px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; font-weight: bold;">Login</a>
    </div>
    
    <div id="userSection" style="display: none; background-color: #2E2E2E; padding: 10px; border-radius: 8px; border: 1px solid #8D6E63; min-width: 200px;">
      <p style="color: #FFD700; margin: 0 0 8px 0; text-align: center; font-weight: bold;" id="userName"></p>
      <div style="text-align: center;">
        <button id="logoutBtn" style="background-color: #3E2723; color: #F5F5F5; border: 1px solid #8D6E63; padding: 5px 15px; border-radius: 4px; font-size: 12px;">Logout</button>
      </div>
    </div>
  </div>

  <!-- Tab Navigation -->
  <div class="tab-container">
    <div class="tab-header">
      <button class="tab-button active" onclick="openTab(event, 'week7-picks')">Week 7 Picks</button>
      <button class="tab-button" onclick="openTab(event, 'week6-results')">Week 6 Results</button>
    </div>
  </div>

  <!-- Week 7 Picks Tab -->
  <div id="week7-picks" class="tab-content active">
    <div class="title-section">
      <h1 class="title">Week 7 Picks</h1>
      <!-- Mobile Coach Corso Image (appears next to title) -->
      <div class="mobile-title-image">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
      </div>
    </div>
    
    <div class="week7-layout">
      <div class="form-section">
        <!-- Prediction Form -->
        <form name="predictions" method="POST" netlify>    
          <p>
            <label>Your Name: 
              <input id="yourname" name="user" type="text" required />
            </label>
          </p>
          
          <!-- Mobile Coach Corso Button (appears after name field) -->
          <div class="mobile-coach-corso">
            <div class="image-section">
              <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
              <button class="coach-corso-btn" onclick="scrollToCoachCorso()">Need Help? Ask Coach Corso!</button>
            </div>
          </div>
          
          <p>
            <label><span class="games">Game 1:</span> <span class="game-text">8 Alabama at 14 Missouri</span>
              <span class="betting-line">+3.5</span>
              <select name="game1">
                <option value="BAMA">BAMA</option>
                <option value="MIZZ">MIZZ</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 2:</span> 1 Ohio State at 17 Illinois
              <span class="betting-line">+14.5</span>
              <select name="game2">
                <option value="OSU">OSU</option>
                <option value="ILLI">ILLI</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 3:</span> 6 Oklahoma at Texas
              <span class="betting-line">+1.5</span>
              <select name="game3">
                <option value="OKLA">OKLA</option>
                <option value="TEX">TEX</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 4:</span> 7 Indiana at 3 Oregon 
              <span class="betting-line">-7.5</span>
              <select name="game4">
                <option value="IND">IND</option>
                <option value="ORE">ORE</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 5:</span> Florida at 5 Texas A&M
              <span class="betting-line">-7.5</span>
              <select name="game5">
                <option value="FLOR">FLOR</option>
                <option value="A&M">A&M</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 6:</span> Arkansas at 12 Tennessee
              <span class="betting-line">-11.5</span>
              <select name="game6">
                <option value="ARK">ARK</option>
                <option value="TENN">TENN</option>
              </select>
            </label>
          </p>

          <p>
          <label><span class="games">Game 7:</span> 10 Georgia at Auburn
              <span class="betting-line">+3.5</span>
              <select name="game7">
                <option value="UGA">UGA</option>
                <option value="AUB">AUB</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 8:</span> 15 Michigan at USC
              <span class="betting-line">-2.5</span>
              <select name="game8">
                <option value="MICH">MICH</option>
                <option value="USC">USC</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 9:</span> South Carolina at 11 LSU
              <span class="betting-line">-9.5</span>
              <select name="game9">
                <option value="SCAR">SCAR</option>
                <option value="LSU">LSU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 10:</span> 21 Arizona State at Utah
              <span class="betting-line">-5.5</span>
              <select name="game10">
                <option value="AZST">AZST</option>
                <option value="UTAH">UTAH</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 11:</span> Pitt at 25 Florida State
              <span class="betting-line">-10.5</span>
              <select name="game11">
                <option value="PITT">PITT</option>
                <option value="FSU">FSU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 12:</span> 18 BYU at Arizona
              <span class="betting-line">+1.5</span>
              <select name="game12">
                <option value="BYU">BYU</option>
                <option value="AZ">AZ</option>
              </select>
            </label>
          </p>

          <p>
            <button id="submit" type="submit">Submit Predictions</button>
            <a href="prediction-history.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">View Individual History</a>
            <a href="index.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">Back to Main Site</a> 
            
          </p>
        </form>
        <div id="results"></div>
      </div>
      
      <div class="image-section">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
        <button class="coach-corso-btn" onclick="scrollToCoachCorso()">Need Help? Ask Coach Corso!</button>
      </div>
    </div>
    
    <!-- Coach Corso Says Section -->
    <div id="coach-corso-section" class="coach-corso-container">
      <h2 class="coach-corso-title">üèà Coach Corso Says...</h2>
      <div class="coach-corso-content">
          <div class="corso-tip">
            <span class="tip-icon">üèÉ‚Äç‚ôÇÔ∏è</span>
            <span class="tip-text">Alabama faces Missouri's explosive rushing attack - keep your eyes on #29 and #3!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">ü§ï</span>
            <span class="tip-text">The Red River Shootout is a toss-up with John Mateer returning from thumb surgery, is he healthy?</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üëª</span>
            <span class="tip-text">Georgia vs Auburn: Kirby Smart travels to the haunted plains and voodoo at Jordan-Hare!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üèçÔ∏è</span>
            <span class="tip-text">Bobby Petrino is back as Arkansas HC - stay on the lookout for motorcycles!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üíº</span>
            <span class="tip-text">Will Florida revive their season or will Billy Napier be fired?</span>
          </div>
           <div class="corso-tip">
             <span class="tip-icon">ü¶Å</span>
             <span class="tip-text">Look out for South Carolina in wounded animal mode at LSU. Lanorris Sellers could be in for a big game!</span>
           </div>
      </div>
    </div>
  </div>

  <!-- Week 6 Results Tab -->
  <div id="week6-results" class="tab-content">
    <h1 class="title">Week 6 Results</h1>
    
    <div class="leaderboards-container">
      <div class="Leaderboard last-week">
        <h3 class="leaderboard-title">üèÜ Last Week</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Logan 11-1 <span class="percentage">92%</span></li>
          <li class="leaderboard-list-item">Michaela 10-2 <span class="percentage">83%</span></li>
          <li class="leaderboard-list-item">Katelyn 9-3 <span class="percentage">75%</span></li>
          <li class="leaderboard-list-item">Gracie 9-3 <span class="percentage">75%</span></li>
          <li class="leaderboard-list-item">Allie 8-4 <span class="percentage">67%</span></li>
          <li class="leaderboard-list-item">Blake 8-4 <span class="percentage">67%</span></li>
          <li class="leaderboard-list-item">üòîChase 7-5 <span class="percentage">58%</span></li>
        </ol>
      </div>
      <div class="Leaderboard all-time">
        <h3 class="leaderboard-title">üèÜ All Time</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Michaela 39-9 <span class="percentage">81.25%</span></li>
          <li class="leaderboard-list-item">Blake 42-18 <span class="percentage">70%</span></li>
          <li class="leaderboard-list-item">Gracie 41-19 <span class="percentage">68.33%</span></li>
          <li class="leaderboard-list-item">Logan 40-20 <span class="percentage">66.67%</span></li>
          <li class="leaderboard-list-item">Katelyn 32-16 <span class="percentage">66.67%</span></li>
          <li class="leaderboard-list-item">Allie 8-4 <span class="percentage">66.67%</span></li>
          <li class="leaderboard-list-item">Chase 15-9 <span class="percentage">62.5%</span></li>
        </ol>
      </div>
    </div>

    <!-- WEEK 6 Analysis Section -->
    <div class="analysis-container">
      <h3 class="analysis-title">üìä WEEK 6 Analysis</h3>
      <div class="analysis-content">
        <div class="analysis-stats">
          <div class="stat-highlight">
            <span class="stat-icon">üéØ</span>
            <span class="stat-text">Katelyn and Logan are the only users to correctly pick Florida to upset Texas</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üî•</span>
            <span class="stat-text">100% consensus on Alabama Beating Vanderbilt</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üèÜ</span>
            <span class="stat-text">Michaela's dominance: Is 10-2 for the 3rd week this season</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üìà</span>
            <span class="stat-text">All users combined this week went 62-22 (73.8%)</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">‚ùå</span>
            <span class="stat-text">I didn't even bother putting Penn State in this week because I thought they had an easy win. (Wrong)</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üèÜ</span>
            <span class="stat-text">Blake the only user to correctly pick Cincinnati to beat Iowa State</span>
          </div>
        </div>
        
        <div class="analysis-insights">
          <h4 class="insights-title">üîë Keys for Next Week</h4>
          <ul class="insights-list">
            <li>Alabama will play against the best running back in CFB, Ahmad Hardy</li>
            <li>Oklahoma QB (John Mateer) coming back from thumb surgery against Texas</li>
            <li>More to come...</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  



    <script>
    // Login/Logout functionality
    let currentUser = null;

    // Check if user is logged in on page load
    document.addEventListener('DOMContentLoaded', function() {
      const savedUser = localStorage.getItem('currentUser');
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        showUserSection();
        // Name field is now user-editable
      } else {
        showLoginButton();
      }
    });

    // Logout handler
    document.getElementById('logoutBtn').addEventListener('click', function() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      showLoginButton();
      // Name field remains user-editable
    });

    function showUserSection() {
      document.getElementById('loginButtonSection').style.display = 'none';
      document.getElementById('userSection').style.display = 'block';
      document.getElementById('userName').textContent = currentUser.username;
    }

    function showLoginButton() {
      document.getElementById('loginButtonSection').style.display = 'block';
      document.getElementById('userSection').style.display = 'none';
    }

    // Prediction form handler
    document.querySelector('form[name="predictions"]').addEventListener('submit', function(e) {
      e.preventDefault();

      // No login required for Netlify Forms

      const form = e.target;
      const formData = new FormData(form);
     
      // Build preview
      const user = formData.get("user");
      let html = `
        <div class="prediction-results-container">
          <div class="prediction-header">
            <h2 class="prediction-title">üèÜ ${user}'s Week 7 Predictions</h2>
          </div>
          <div class="predictions-grid">
      `;
      
      for (let i = 1; i <= 12; i++) {
        const gameData = [
          "8 Alabama at 14 Missouri",
          "1 Ohio State at 17 Illinois",
          "6 Oklahoma at Texas",
          "7 Indiana at 3 Oregon",
          "Florida at 5 Texas A&M",
          "Arkansas at 12 Tennessee",
          "10 Georgia at Auburn",
          "15 Michigan at USC",
          "South Carolina at 11 LSU",
          "21 Arizona State at Utah",
          "Pittsburgh at 25 Florida State",
          "18 BYU at Arizona"
        ];
        
        const prediction = formData.get("game" + i);
        
        html += `
          <div class="prediction-card">
            <div class="game-info">
              <span class="game-number">Game ${i}</span>
              <span class="game-matchup">${gameData[i-1]}</span>
            </div>
            <div class="prediction-result">
              <span class="prediction-choice ${prediction.toLowerCase()}">${prediction}</span>
            </div>
          </div>
        `;
      }
      
      html += `
          </div>
          <div class="prediction-summary">
          <div class="summary-stats">
            <div class="stat-item">
              <span class="stat-number">12</span>
              <span class="stat-label">Total Picks</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Correct</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Accuracy</span>
            </div>
          </div>
            <div class="prediction-footer">
              <p class="success-message">‚úÖ Predictions submitted successfully!</p>
              <p class="next-steps">Check back after the games to see how you did!</p>
              <div class="screenshot-section">
                <button id="screenshotBtn" class="screenshot-button">
                  üì∏ Save to Photos
                </button>
                <p class="screenshot-note">Save your predictions to your camera roll!</p>
              </div>
            </div>
          </div>
        </div>
      `;
      
      document.getElementById("results").innerHTML = html;

      // Add screenshot functionality
      document.getElementById('screenshotBtn').addEventListener('click', function() {
        takeScreenshot();
      });

      // Submit to Netlify Forms
      fetch("/", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: new URLSearchParams({
          "form-name": "predictions",
          ...Object.fromEntries(formData)
        }).toString()
      })
      .then(() => {
        // Scroll after fetch completes
        setTimeout(() => {
          document.getElementById("results").scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
          });
        }, 100); // slight delay for smoother experience
      })
      .catch(err => console.error(err));
    });

    // Screenshot functionality
    function takeScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Check if html2canvas is available (we'll add it via CDN)
      if (typeof html2canvas === 'undefined') {
        // Load html2canvas library
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
        script.onload = function() {
          captureScreenshot();
        };
        document.head.appendChild(script);
      } else {
        captureScreenshot();
      }
    }

    function captureScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Create a temporary container with only the content we want to screenshot
      const tempContainer = document.createElement('div');
      tempContainer.style.position = 'absolute';
      tempContainer.style.left = '-9999px';
      tempContainer.style.top = '-9999px';
      tempContainer.style.width = resultsContainer.offsetWidth + 'px';
      tempContainer.style.backgroundColor = '#1E1E1E';
      tempContainer.style.padding = '2rem';
      tempContainer.style.borderRadius = '15px';
      tempContainer.style.border = '2px solid #FFD700';
      
      // Clone the content we want (exclude success messages and screenshot button)
      const predictionContainer = resultsContainer.querySelector('.prediction-results-container');
      if (predictionContainer) {
        const clone = predictionContainer.cloneNode(true);
        
        // Remove the prediction footer (success messages and screenshot button)
        const footer = clone.querySelector('.prediction-footer');
        if (footer) {
          footer.remove();
        }
        
        tempContainer.appendChild(clone);
        document.body.appendChild(tempContainer);
      }
      
      html2canvas(tempContainer, {
        backgroundColor: '#1E1E1E',
        scale: 2, // Higher quality
        useCORS: true,
        allowTaint: true,
        scrollX: 0,
        scrollY: 0,
        width: tempContainer.scrollWidth,
        height: tempContainer.scrollHeight
      }).then(canvas => {
        // Check if Web Share API is supported (mobile)
        if (navigator.share && navigator.canShare) {
          canvas.toBlob(function(blob) {
            const file = new File([blob], `week7-predictions-${new Date().toISOString().split('T')[0]}.png`, { 
              type: 'image/png' 
            });
            
            // Use Web Share API for mobile
            if (navigator.canShare({ files: [file] })) {
              navigator.share({
                files: [file],
                title: 'My Week 7 Predictions',
                text: 'Check out my college football predictions!'
              }).then(() => {
                showSuccessMessage('Shared! Check your share options to save to photos.');
              }).catch((error) => {
                console.log('Share failed:', error);
                fallbackDownload(canvas);
              });
            } else {
              fallbackDownload(canvas);
            }
          });
        } else {
          // Fallback for desktop or unsupported browsers
          fallbackDownload(canvas);
        }
      }).catch(err => {
        console.error('Screenshot failed:', err);
        alert('Screenshot failed. Please try again.');
      }).finally(() => {
        // Clean up temporary container
        if (tempContainer && tempContainer.parentNode) {
          tempContainer.parentNode.removeChild(tempContainer);
        }
      });
    }

    function fallbackDownload(canvas) {
      // Create download link for desktop/fallback
      const link = document.createElement('a');
      link.download = `week7-predictions-${new Date().toISOString().split('T')[0]}.png`;
      link.href = canvas.toDataURL();
      
      // Trigger download
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showSuccessMessage('Downloaded! Check your Downloads folder.');
    }

    function showSuccessMessage(message) {
      const btn = document.getElementById('screenshotBtn');
      const originalText = btn.innerHTML;
      btn.innerHTML = '‚úÖ ' + message;
      btn.style.backgroundColor = '#4CAF50';
      
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.backgroundColor = '';
      }, 3000);
    }

    // Tab functionality
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      
      // Hide all tab content
      tabcontent = document.getElementsByClassName("tab-content");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].classList.remove("active");
      }
      
      // Remove active class from all tab buttons
      tablinks = document.getElementsByClassName("tab-button");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
      }
      
      // Show the selected tab content and mark the button as active
      document.getElementById(tabName).classList.add("active");
      evt.currentTarget.classList.add("active");
    }

    // Coach Corso scroll functionality
    function scrollToCoachCorso() {
      document.getElementById('coach-corso-section').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }

</script>
</body>
</html>
