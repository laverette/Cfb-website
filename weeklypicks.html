<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Picks</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="./Resources/Styles/weeklypicks.css">
</head>
<body>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Bouncing Football Background -->
  <div class="bouncing-football">
    <img src="https://cdn-icons-png.flaticon.com/512/1133/1133780.png" alt="American Football" style="width: 100%; height: 100%; object-fit: contain;">
  </div>
  
  <!-- Login Button - Upper Right -->
  <div style="position: fixed; top: 10px; right: 10px; z-index: 1000; display: block;">
    <div id="loginButtonSection">
      <a href="login.html" style="background-color: #3E2723; color: #F5F5F5; padding: 8px 16px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; font-weight: bold;">Login</a>
    </div>
    
    <div id="userSection" style="display: none; background-color: #2E2E2E; padding: 10px; border-radius: 8px; border: 1px solid #8D6E63; min-width: 200px;">
      <p style="color: #FFD700; margin: 0 0 8px 0; text-align: center; font-weight: bold;" id="userName"></p>
      <div style="text-align: center;">
        <button id="logoutBtn" style="background-color: #3E2723; color: #F5F5F5; border: 1px solid #8D6E63; padding: 5px 15px; border-radius: 4px; font-size: 12px;">Logout</button>
      </div>
    </div>
  </div>

  <!-- Tab Navigation -->
  <div class="tab-container">
    <div class="tab-header">
      <button class="tab-button active" onclick="openTab(event, 'week11-picks')">Week 11 Picks</button>
      <button class="tab-button" onclick="openTab(event, 'week10-results')">Week 10 Results</button>
    </div>
  </div>

  <!-- Week 11 Picks Tab -->
  <div id="week11-picks" class="tab-content active">
    <div class="title-section">
      <h1 class="title">Week 11 Picks</h1>
      <!-- Mobile Coach Corso Image (appears next to title) -->
      <div class="mobile-title-image">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
      </div>
    </div>
    
    <div class="week11-layout">
      <div class="form-section">
        <!-- Prediction Form -->
        <form name="predictions" method="POST" id="predictionsForm" netlify data-netlify="true">
          <input type="hidden" name="form-name" value="predictions" />
          <p>
            <label>Your Name: 
              <input id="yourname" name="user" type="text" required />
            </label>
          </p>
          
          <!-- Mobile Coach Corso Button (appears after name field, before Game 1) -->
          <div class="mobile-coach-corso">
            <div class="image-section">
              <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
              <button type="button" class="coach-corso-btn" onclick="scrollToCoachCorso(event)">Need Help? Ask Coach Corso!</button>
            </div>
          </div>
          
          <!-- Rivalry Game Card -->
          <div class="rivalry-card">
            <div class="rivalry-header">
              <div class="rivalry-title">
                <span class="rivalry-icon" style="font-size: 32px;">üçÅ</span>
                <span class="rivalry-name" onclick="showFirstSaturdayRivalry()">The First Saturday in November</span>
              </div>
              <div class="rivalry-teams">
                <div class="team-info">
                  <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/333.png" alt="Alabama" class="rivalry-logo">
                  <span class="team-name">Alabama</span>
                </div>
                <span class="vs">VS</span>
                <div class="team-info">
                  <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/99.png" alt="LSU" class="rivalry-logo">
                  <span class="team-name">LSU</span>
                </div>
                <span class="betting-line">+14.5</span>
              </div>
            </div>
            <div class="game-controls">
              <select name="game1">
                <option value="ALA">ALA</option>
                <option value="LSU">LSU</option>
              </select>
            </div>
          </div>

          <p>
            <label><span class="games">Game 2:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/61.png" alt="Georgia" class="team-logo"> 5 Georgia at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/344.png" alt="Mississippi State" class="team-logo"> Mississippi State
              <span class="betting-line">+7.5</span>
              <select name="game2">
                <option value="UGA">UGA</option>
                <option value="MSST">MSST</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 3:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/252.png" alt="BYU" class="team-logo"> 8 BYU at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2641.png" alt="Texas Tech" class="team-logo"> 9 Texas Tech
              <span class="betting-line">-10.5</span>
              <select name="game3">
                <option value="BYU">BYU</option>
                <option value="TTU">TTU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 4:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/84.png" alt="Indiana" class="team-logo"> 2 Indiana at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/213.png" alt="Penn State" class="team-logo"> 6 Penn State
              <span class="betting-line">+14.5</span>
              <select name="game4">
                <option value="IND">IND</option>
                <option value="PSU">PSU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 5:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/245.png" alt="Texas A&M" class="team-logo"> 3 Texas A&M at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/142.png" alt="Missouri" class="team-logo"> Missouri
              <span class="betting-line">+6.5</span>
              <select name="game5">
                <option value="TAMU">TAMU</option>
                <option value="MIZ">MIZ</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 6:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2483.png" alt="Oregon" class="team-logo"> 4 Oregon at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2294.png" alt="Iowa" class="team-logo"> Iowa
              <span class="betting-line">+6.5</span>
              <select name="game6">
                <option value="ORE">ORE</option>
                <option value="IOWA">IOWA</option>
              </select>
            </label>
          </p>

          <p>
          <label><span class="games">Game 7:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2.png" alt="Auburn" class="team-logo"> Auburn at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/238.png" alt="Vanderbilt" class="team-logo"> Vanderbilt
              <span class="betting-line">-7.5</span>
              <select name="game7">
                <option value="AUB">AUB</option>
                <option value="VANDY">VANDY</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 8:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/264.png" alt="Washington" class="team-logo"> Washington at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/275.png" alt="Wisconsin" class="team-logo"> Wisconsin
              <span class="betting-line">+11.5</span>
              <select name="game8">
                <option value="WASH">WASH</option>
                <option value="WISC">WISC</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 9:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/154.png" alt="Wake Forest" class="team-logo"> Wake Forest at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/258.png" alt="Virginia" class="team-logo"> Virginia
              <span class="betting-line">-6.5</span>
              <select name="game9">
                <option value="WAKE">WAKE</option>
                <option value="UVA">UVA</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 10:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/25.png" alt="California" class="team-logo"> California at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/97.png" alt="Louisville" class="team-logo"> Louisville
              <span class="betting-line">-18.5</span>
              <select name="game10">
                <option value="CAL">CAL</option>
                <option value="LOU">LOU</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 11:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2426.png" alt="Navy" class="team-logo"> Navy at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/87.png" alt="Notre Dame" class="team-logo"> 10 Notre Dame
              <span class="betting-line">-24.5</span>
              <select name="game11">
                <option value="NAVY">NAVY</option>
                <option value="ND">ND</option>
              </select>
            </label>
          </p>

          <p>
            <label><span class="games">Game 12:</span> 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/66.png" alt="Iowa State" class="team-logo"> Iowa State at 
              <img src="https://a.espncdn.com/i/teamlogos/ncaa/500/2628.png" alt="TCU" class="team-logo"> TCU
              <span class="betting-line">-6.5</span>
              <select name="game12">
                <option value="ISU">ISU</option>
                <option value="TCU">TCU</option>
              </select>
            </label>
          </p>
             
          <p>
            <button id="submit" type="submit">Submit Predictions</button>
            <a href="prediction-history.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">View Individual History</a>
            <a href="index.html" style="background-color: #3E2723; color: #F5F5F5; padding: 6px 10px; border-radius: 6px; text-decoration: none; border: 1px solid #8D6E63; display: inline-block; font-weight: bold; font-size: 14px; margin-left: 10px; margin-right: 10px;">Back to Main Site</a> 
            
          </p>
        </form>
        <div id="results"></div>
      </div>
      
      <div class="image-section">
        <img width="100%" height="auto" src="https://images.seattletimes.com/wp-content/uploads/2017/05/2459f782f2c946859a21920650fc2c75.jpg?d=2040x1253" alt="Image" class="img-fluid rounded shadow big-img" style="max-height: 300px; object-fit: cover;">
        <button type="button" class="coach-corso-btn" onclick="scrollToCoachCorso(event)">Need Help? Ask Coach Corso!</button>
      </div>
    </div>
    
    <!-- Coach Corso Says Section -->
    <div id="coach-corso-section" class="coach-corso-container">
      <h2 class="coach-corso-title">üèà Coach Corso Says...</h2>
      <div class="coach-corso-content">
          <div class="corso-tip">
            <span class="tip-icon">üçÅ</span>
            <span class="tip-text">The First Saturday in November! Alabama vs LSU! The Tide's defense is locked in, and LSU just lost their head coach. This one might not be as close as the 2019 classic, but it's still the biggest game in the SEC West! Roll Tide!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêï</span>
            <span class="tip-text">Georgia at Mississippi State! The Dawgs are #5 and rolling, but playing in Starkville is never easy. Still, Georgia should cover that 10-point spread!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üî•</span>
            <span class="tip-text">BYU at Texas Tech! Both teams are ranked in the top 10, but the Red Raiders are at home and favored by 10.5. Tech wins big!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üîµ</span>
            <span class="tip-text">Indiana at Penn State! The Hoosiers are #2 and favored, but Happy Valley is a tough place to play! Give me Indiana but it'll be close!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêÖ</span>
            <span class="tip-text">Texas A&M at Missouri! The Aggies are #3 and rolling, but the Tigers are at home. Still, A&M should handle business in Columbia!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">ü¶Ü</span>
            <span class="tip-text">Oregon at Iowa! The Ducks are #4 and favored by 7, but Kinnick Stadium at night is no joke. Oregon wins but Iowa covers!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêÖ</span>
            <span class="tip-text">Auburn at Vanderbilt! The Tigers are favored by 8, but Vandy has been playing tough at home. Give me Auburn to cover!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üî¥</span>
            <span class="tip-text">Washington at Wisconsin! The Badgers are favored by 3.5 at home in Camp Randall. That place gets LOUD! Wisconsin wins!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üåä</span>
            <span class="tip-text">Wake Forest at Virginia! The Cavaliers are favored by 4.5 at home. UVA takes care of business in Charlottesville!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üêª</span>
            <span class="tip-text">California at Louisville! The Cardinals are favored by 6 at home. Louisville's offense should be too much for Cal!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">‚õ™</span>
            <span class="tip-text">Navy at Notre Dame! The Fighting Irish are #10 and favored by 7. Navy always plays ND tough, but the Irish win at home!</span>
          </div>
          <div class="corso-tip">
            <span class="tip-icon">üê∏</span>
            <span class="tip-text">Iowa State at TCU! The Horned Frogs are favored by 2 at home. This is a toss-up, but give me TCU in Fort Worth!</span>
          </div>
      </div>
    </div>
  </div>

  <!-- Week 10 Results Tab -->
  <div id="week10-results" class="tab-content">
    <h1 class="title">Week 10 Results</h1>
    
    <div class="leaderboards-container">
      <div class="Leaderboard last-week">
        <h3 class="leaderboard-title">üèÜ Last Week</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Logan 9-3 <span class="percentage">75%</span><span class="ranking-change up">‚ñ≤ 3</span></li>
          <li class="leaderboard-list-item">Gracie 8-4 <span class="percentage">67%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Blake's AI Model 8-4 <span class="percentage">67%</span><span class="ranking-change up">‚ñ≤ 2</span></li>
          <li class="leaderboard-list-item">(Cliff Sheep Murderer) 7-5 <span class="percentage">58%</span><span class="ranking-change down">‚ñº 1</span></li>
          <li class="leaderboard-list-item">Blake 7-5 <span class="percentage">58%</span><span class="ranking-change down">‚ñº 4</span></li>
          <li class="leaderboard-list-item">Katelyn 7-5 <span class="percentage">58%</span><span class="ranking-change down">‚ñº 4</span></li>
          <li class="leaderboard-list-item">Chase 7-5 <span class="percentage">58%</span><span class="ranking-change none">-</span></li> 
        </ol>
      </div>
      <div class="Leaderboard all-time">
        <h3 class="leaderboard-title">üèÜ All Time</h3>
        <ol class="leaderboard-list">
          <li class="leaderboard-list-item">Blake 80-28 <span class="percentage">74.07%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Michaela 70-26 <span class="percentage">72.92%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Katelyn 67-29 <span class="percentage">69.79%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Gracie 67-29 <span class="percentage">69.79%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Logan 73-35 <span class="percentage">67.59%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Chase 31-17 <span class="percentage">64.58%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Allie 22-14 <span class="percentage">61.1%</span><span class="ranking-change none">-</span></li>
          <li class="leaderboard-list-item">Blake's AI Model 25-11 <span class="percentage">69.44%</span><span class="ranking-change none">‚Äî</span></li>
        </ol>
      </div>
    </div>

    <!-- WEEK 10 Analysis Section -->
    <div class="analysis-container">
      <h3 class="analysis-title">üìä WEEK 10 Analysis</h3>
      <div class="analysis-content">
        <div class="analysis-stats">
          <div class="stat-highlight">
            <span class="stat-icon">üîí</span>
            <span class="stat-text">Nobody moved a single spot on the all time leaderboard this week.</span>
          </div>
          <div class="stat-highlight">
              <span class="stat-icon">üí•</span>
              <span class="stat-text">No one correctly picked SMU to upset Miami this week</span>
            </div>
          <div class="stat-highlight">
            <span class="stat-icon">üêò</span>
            <span class="stat-text">Logan and Blake's AI model were the only two users to correctly pick Texas to beat Vanderbilt this week.</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üìâ</span>
            <span class="stat-text">All users combined this week went 53-31 (63.1%). Down 16.9% from last week.</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üö´</span>
            <span class="stat-text">No one correcly picked Oklahoma to beat Tennessee this week.</span>
          </div>
          <div class="stat-highlight">
            <span class="stat-icon">üé∞</span>
            <span class="stat-text">No one correctly picked NC State to beat Georgia Tech this week. (Vegas did know something)</span>
          </div>
        </div>
        
        <div class="analysis-insights">
          <h4 class="insights-title">üîë Keys for Week 10</h4>
          <ul class="insights-list">
            <li>Auburn has actually fired their head coach.</li>
            <li>How will LSU look with a new coach?</li>
            <li>Has Arch Manning stepped up? Is Texas for real?</li>
          
          </ul>
        </div>
      </div>
    </div>
  </div>
  



    <script>
    // Login/Logout functionality - simplified, no authentication required
    let currentUser = null;

    // Check if user is logged in on page load (optional, no requirement)
    document.addEventListener('DOMContentLoaded', function() {
      const savedUser = localStorage.getItem('currentUser');
      const authToken = localStorage.getItem('authToken');
      
      if (savedUser && authToken) {
        currentUser = JSON.parse(savedUser);
        showUserSection();
        
        // Pre-fill name field with username or displayName if available
        const nameInput = document.getElementById('yourname');
        if (nameInput && currentUser) {
          nameInput.value = currentUser.displayName || currentUser.username || '';
        }
      } else {
        showLoginButton();
      }
    });

    // Logout handler
    document.getElementById('logoutBtn')?.addEventListener('click', function() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      localStorage.removeItem('authToken');
      showLoginButton();
      
      // Clear name field
      const nameInput = document.getElementById('yourname');
      if (nameInput) {
        nameInput.value = '';
      }
    });

    function showUserSection() {
      const loginSection = document.getElementById('loginButtonSection');
      const userSection = document.getElementById('userSection');
      if (loginSection) loginSection.style.display = 'none';
      if (userSection) {
        userSection.style.display = 'block';
        // Display username or displayName
        const displayName = currentUser?.displayName || currentUser?.username || 'User';
        const userNameEl = document.getElementById('userName');
        if (userNameEl) userNameEl.textContent = displayName;
      }
    }

    function showLoginButton() {
      const loginSection = document.getElementById('loginButtonSection');
      const userSection = document.getElementById('userSection');
      if (loginSection) loginSection.style.display = 'block';
      if (userSection) userSection.style.display = 'none';
    }

    const weekId = 1; // Update this to match your week_id from database (check Weeks table)

    // Team code to ESPN ID mapping (for the dropdown values)
    const teamCodeToEspnId = {
      // Game 1: Alabama vs LSU
      'ALA': 333, 'LSU': 99,
      // Game 2: Georgia at Mississippi State
      'UGA': 61, 'MSST': 344,
      // Game 3: BYU at Texas Tech
      'BYU': 252, 'TTU': 2641,
      // Game 4: Indiana at Penn State
      'IND': 84, 'PSU': 213,
      // Game 5: Texas A&M at Missouri
      'TAMU': 245, 'MIZ': 142,
      // Game 6: Oregon at Iowa
      'ORE': 2483, 'IOWA': 2294,
      // Game 7: Auburn at Vanderbilt
      'AUB': 2, 'VANDY': 238,
      // Game 8: Washington at Wisconsin
      'WASH': 264, 'WISC': 275,
      // Game 9: Wake Forest at Virginia
      'WAKE': 154, 'UVA': 258,
      // Game 10: California at Louisville
      'CAL': 25, 'LOU': 97,
      // Game 11: Navy at Notre Dame
      'NAVY': 2426, 'ND': 87,
      // Game 12: Iowa State at TCU
      'ISU': 66, 'TCU': 2628
    };

    // No longer need to load games from API - we use game_number (1-12) directly

    // Submission status check removed - no authentication required

    // Prediction form handler - Submit to Netlify Forms
    document.querySelector('form[name="predictions"]').addEventListener('submit', async function(e) {
      e.preventDefault();

      const form = e.target;
      const formData = new FormData(form);
      
      // Validate all picks are selected
      const missingPicks = [];
      
      for (let i = 1; i <= 12; i++) {
        const pickedCode = formData.get(`game${i}`);
        if (!pickedCode) {
          missingPicks.push(`Game ${i}`);
        }
      }

      if (missingPicks.length > 0) {
        alert(`Please select picks for all 12 games!\n\nMissing: ${missingPicks.length} games`);
        return;
      }

      // Show loading state
      const submitBtn = document.getElementById('submit');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting...';
      submitBtn.disabled = true;
      
      try {
        // Submit to Netlify Forms using fetch
        // Add form-name for Netlify to recognize the form
        const formDataWithName = new URLSearchParams(formData);
        formDataWithName.append('form-name', 'predictions');
        
        const response = await fetch('/', {
          method: 'POST',
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: formDataWithName.toString()
        });

        if (response.ok) {
          // Build preview (keep the existing preview functionality)
          const userName = formData.get("user") || "Guest";
          let html = `
        <div class="prediction-results-container">
          <div class="prediction-header">
            <h2 class="prediction-title">üèÜ ${userName}'s Week 11 Predictions</h2>
          </div>
          <div class="predictions-grid">
      `;
      
      for (let i = 1; i <= 12; i++) {
        const gameData = [
        "Alabama vs LSU",
        "5 Georgia at Mississippi State",
        "8 BYU at 9 Texas Tech",
        "2 Indiana at 6 Penn State",
        "3 Texas A&M at Missouri",
        "4 Oregon at Iowa",
        "Auburn at Vanderbilt",
        "Washington at Wisconsin",
        "Wake Forest at Virginia",
        "California at Louisville",
        "Navy at 10 Notre Dame",
        "Iowa State at TCU"
        ];
        
        const prediction = formData.get("game" + i);
        
        html += `
          <div class="prediction-card">
            <div class="game-info">
              <span class="game-number">Game ${i}</span>
              <span class="game-matchup">${gameData[i-1]}</span>
            </div>
            <div class="prediction-result">
              <span class="prediction-choice ${prediction.toLowerCase()}">${prediction}</span>
            </div>
          </div>
        `;
      }
      
      html += `
          </div>
          <div class="prediction-summary">
          <div class="summary-stats">
            <div class="stat-item">
              <span class="stat-number">12</span>
              <span class="stat-label">Total Picks</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Correct</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">-</span>
              <span class="stat-label">Accuracy</span>
            </div>
          </div>
            <div class="prediction-footer">
              <p class="success-message">‚úÖ Predictions submitted successfully!</p>
              <p class="next-steps">Check back after the games to see how you did!</p>
              <div class="screenshot-section">
                <button id="screenshotBtn" class="screenshot-button">
                  üì∏ Save to Photos
                </button>
                <p class="screenshot-note">Save your predictions to your camera roll!</p>
              </div>
            </div>
          </div>
        </div>
      `;
      
          // Show success message
          document.getElementById("results").innerHTML = html;
          
          // Scroll to results
          setTimeout(() => {
            document.getElementById("results").scrollIntoView({ 
              behavior: 'smooth',
              block: 'start'
            });
          }, 100);
          
          // Add screenshot functionality
          const screenshotBtn = document.getElementById('screenshotBtn');
          if (screenshotBtn) {
            screenshotBtn.addEventListener('click', function() {
              takeScreenshot();
            });
          }
          
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
        } else {
          alert(`Error submitting picks. Please try again.`);
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
        }
      } catch (error) {
        console.error('Error submitting picks:', error);
        alert(`Error submitting picks. Please try again.`);
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    });

    // Screenshot functionality
    function takeScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Check if html2canvas is available (we'll add it via CDN)
      if (typeof html2canvas === 'undefined') {
        // Load html2canvas library
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
        script.onload = function() {
          captureScreenshot();
        };
        document.head.appendChild(script);
      } else {
        captureScreenshot();
      }
    }

    function captureScreenshot() {
      const resultsContainer = document.getElementById('results');
      
      // Create a temporary container with only the content we want to screenshot
      const tempContainer = document.createElement('div');
      tempContainer.style.position = 'absolute';
      tempContainer.style.left = '-9999px';
      tempContainer.style.top = '-9999px';
      tempContainer.style.width = '100vw'; // Use full viewport width
      tempContainer.style.maxWidth = '100vw';
      tempContainer.style.backgroundColor = '#1E1E1E';
      tempContainer.style.padding = '1rem';
      tempContainer.style.borderRadius = '15px';
      tempContainer.style.border = '2px solid #FFD700';
      tempContainer.style.boxSizing = 'border-box';
      tempContainer.style.overflow = 'visible';
      
      // Clone the content we want (exclude success messages and screenshot button)
      const predictionContainer = resultsContainer.querySelector('.prediction-results-container');
      if (predictionContainer) {
        const clone = predictionContainer.cloneNode(true);
        
        // Remove the prediction footer (success messages and screenshot button)
        const footer = clone.querySelector('.prediction-footer');
        if (footer) {
          footer.remove();
        }
        
        // Ensure the predictions grid uses full width with 3 columns on mobile
        const predictionsGrid = clone.querySelector('.predictions-grid');
        if (predictionsGrid) {
          predictionsGrid.style.width = '100%';
          predictionsGrid.style.maxWidth = '100%';
          predictionsGrid.style.display = 'grid';
          predictionsGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
          predictionsGrid.style.gap = '0.3rem';
          predictionsGrid.style.padding = '0.3rem';
          predictionsGrid.style.margin = '0';
          predictionsGrid.style.boxSizing = 'border-box';
        }
        
        // Ensure each prediction card fits properly in 3 columns
        const predictionCards = clone.querySelectorAll('.prediction-card');
        predictionCards.forEach(card => {
          card.style.width = '100%';
          card.style.minWidth = '100px';
          card.style.maxWidth = '100%';
          card.style.boxSizing = 'border-box';
          card.style.padding = '0.3rem';
          card.style.fontSize = '0.7rem';
          card.style.margin = '0';
          card.style.overflow = 'visible';
        });
        
        tempContainer.appendChild(clone);
        document.body.appendChild(tempContainer);
      }
      
      html2canvas(tempContainer, {
        backgroundColor: '#1E1E1E',
        scale: 1.2, // Slightly reduced scale for better fit
        useCORS: true,
        allowTaint: true,
        scrollX: 0,
        scrollY: 0,
        width: tempContainer.scrollWidth,
        height: tempContainer.scrollHeight,
        logging: false,
        removeContainer: false,
        x: 0,
        y: 0
      }).then(canvas => {
        // Check if Web Share API is supported (mobile)
        if (navigator.share && navigator.canShare) {
          canvas.toBlob(function(blob) {
            const file = new File([blob], `week11-predictions-${new Date().toISOString().split('T')[0]}.png`, { 
              type: 'image/png' 
            });
            
            // Use Web Share API for mobile
            if (navigator.canShare({ files: [file] })) {
              navigator.share({
                files: [file],
                title: 'My Week 11 Predictions',
                text: 'Check out my college football predictions!'
              }).then(() => {
                showSuccessMessage('Shared! Check your share options to save to photos.');
              }).catch((error) => {
                console.log('Share failed:', error);
                fallbackDownload(canvas);
              });
            } else {
              fallbackDownload(canvas);
            }
          });
        } else {
          // Fallback for desktop or unsupported browsers
          fallbackDownload(canvas);
        }
      }).catch(err => {
        console.error('Screenshot failed:', err);
        alert('Screenshot failed. Please try again.');
      }).finally(() => {
        // Clean up temporary container
        if (tempContainer && tempContainer.parentNode) {
          tempContainer.parentNode.removeChild(tempContainer);
        }
      });
    }

    function fallbackDownload(canvas) {
      // Create download link for desktop/fallback
      const link = document.createElement('a');
      link.download = `week11-predictions-${new Date().toISOString().split('T')[0]}.png`;
      link.href = canvas.toDataURL();
      
      // Trigger download
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showSuccessMessage('Downloaded! Check your Downloads folder.');
    }

    function showSuccessMessage(message) {
      const btn = document.getElementById('screenshotBtn');
      const originalText = btn.innerHTML;
      btn.innerHTML = '‚úÖ ' + message;
      btn.style.backgroundColor = '#4CAF50';
      
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.style.backgroundColor = '';
      }, 3000);
    }

    // Tab functionality
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      
      // Hide all tab content
      tabcontent = document.getElementsByClassName("tab-content");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].classList.remove("active");
      }
      
      // Remove active class from all tab buttons
      tablinks = document.getElementsByClassName("tab-button");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].classList.remove("active");
      }
      
      // Show the selected tab content and mark the button as active
      document.getElementById(tabName).classList.add("active");
      evt.currentTarget.classList.add("active");
    }

    // Coach Corso scroll functionality
    function scrollToCoachCorso(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      document.getElementById('coach-corso-section').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
      });
    }

    // Rivalry History Modal
    function showRivalryHistory() {
      const modal = document.createElement('div');
      modal.className = 'rivalry-modal';
      modal.innerHTML = `
        <div class="rivalry-modal-content">
          <div class="rivalry-modal-header">
            <h3>‚öîÔ∏è The Holy War</h3>
            <span class="close-modal" onclick="closeRivalryModal()">&times;</span>
          </div>
          <div class="rivalry-modal-body">
            <p><strong>Utah vs BYU</strong> - One of college football's most intense rivalries!</p>
            <p><strong>History:</strong> Dating back to 1896, this rivalry represents more than just football - it's a battle between the University of Utah (public, Heathens) and Brigham Young University (private, LDS-affiliated).</p>
            <p><strong>Notable Moments:</strong></p>
            <ul>
              <li>2004: Utah's perfect season with Urban Meyer</li>
              <li>2008: BYU's 48-24 victory in Provo</li>
              <li>2015: Utah's 35-28 thriller in Las Vegas Bowl</li>
            </ul>
            <p><strong>Series Record:</strong> Utah leads 62-31-4</p>
            <p><strong>Why "Holy War":</strong> The nickname reflects the religious and cultural differences between the two institutions, making every game a battle for state supremacy.</p>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    function closeRivalryModal() {
      const modal = document.querySelector('.rivalry-modal');
      if (modal) {
        modal.remove();
      }
    }

    // The First Saturday in November Rivalry Modal
    function showFirstSaturdayRivalry() {
      const modal = document.createElement('div');
      modal.className = 'rivalry-modal';
      modal.innerHTML = `
        <div class="rivalry-modal-content">
          <div class="rivalry-modal-header">
            <h3><span style="font-size: 24px; margin-right: 8px;">üçÅ</span> The First Saturday in November</h3>
            <span class="close-modal" onclick="closeRivalryModal()">&times;</span>
          </div>
          <div class="rivalry-modal-body">
            <p><strong>Alabama vs LSU</strong> - The annual SEC West heavyweight bout that somehow always lives up to the hype.</p>
            <p><strong>This Year's Edition:</strong> Well, 2025's version looks a bit different than the 2019 "Game of the Century II" we all remember (you know, the one where Joe Burrow went nuclear and scored 46 points in Tuscaloosa). Fast forward six years and things have changed: LSU's head coach Brian Kelly got the boot after their shaky start, and now the Tigers are rolling with an interim coach who's probably still figuring out where the water cooler is.</p>
            <p><strong>What to Expect:</strong> The Crimson Tide defense is looking sharp this season, while LSU is... well, they're trying their best. The Tigers have that whole "spirited underdog" thing going for them, which is great for motivational speeches but not so great for actually winning football games against a well-coached Alabama team.</p>
            <p><strong>The Rivalry History:</strong> Dating back to 1895, this showdown has produced some absolute classics. Since Nick Saban arrived in Tuscaloosa in 2007, Alabama has dominated the series 12-4. Ten of those 16 games featured both teams in the top-10, and half were decided by a touchdown or less. This year might be slightly less dramatic, but hey, that's why they play the games.</p>
            <p><strong>Why It Still Matters:</strong> Even with LSU's current situation, this game means everything in the SEC West. Alabama's looking to secure their spot, while LSU's interim coach is probably hoping to keep the job for more than just this weekend. The stakes might be different, but the intensity? That never changes.</p>
            <p><strong>The Bottom Line:</strong> It's November in the SEC. Alabama's rolling. LSU's... regrouping. Time to see if the Tigers can channel some of that 2019 magic, or if the Tide will keep rolling right through Baton Rouge's coaching carousel.</p>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

</script>
</body>
</html>
